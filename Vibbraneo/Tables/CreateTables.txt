USE VIBBRANEO
GO

CREATE TABLE MONTH_REF (
	 [ID_MONTH_REF]	SMALLINT	NOT NULL IDENTITY (1,1)
	,[CD_MONTH_REF]	VARCHAR(2)	NOT NULL 
	,[DE_MONTH_REF]	VARCHAR(30) NOT NULL
	,[DT_ICLO]		DATE		NOT NULL
	,[TM_ICLO]		TIME(7)		NOT NULL
	,CONSTRAINT [PK_MONTH_REF] PRIMARY KEY ([ID_MONTH_REF])
	,CONSTRAINT [AK_MONTH_REF] UNIQUE ([CD_MONTH_REF])
);
GO

CREATE TABLE COMPANY (
	 [ID_COMPANY]	  INT			NOT NULL IDENTITY (1, 1)
    ,[CNPJ]			  VARCHAR (200)	NOT NULL
    ,[NAME]			  VARCHAR (200)	NOT NULL
	,[CORPORATE_NAME] VARCHAR(200)  NOT NULL
	,[DT_ICLO]		  DATE		    NOT NULL
	,[TM_ICLO]		  TIME(7)		NOT NULL
	,CONSTRAINT [PK_COMPANY] PRIMARY KEY ([ID_COMPANY])
	,CONSTRAINT [AK_COMPANY] UNIQUE ([CNPJ])
);
GO

CREATE TABLE INVOICE (
	 [ID_INVOICE]		INT			  NOT NULL IDENTITY (1, 1)
	,[ID_COMPANY]		INT			  NOT NULL
	,[INVOICE_NUMBER]	INT			  NOT NULL
	,[VALUE]			DECIMAL(10,2) NOT NULL
	,[DESCRIPTION]		VARCHAR(200)  NOT NULL
	,[ID_MONTH_REF]		SMALLINT	  NOT NULL
	,[YEAR_REF]			SMALLINT	  NOT NULL
	,[DT_PAYMENT]		DATE		  NOT NULL
	,[DT_ICLO]			DATE		  NOT NULL
	,[TM_ICLO]			TIME(7)		  NOT NULL
	,CONSTRAINT [PK_INVOICE] PRIMARY KEY ([ID_INVOICE])
	,CONSTRAINT [FK_INVOICE_COMPANY] FOREIGN KEY ([ID_COMPANY]) REFERENCES COMPANY ([ID_COMPANY])
	,CONSTRAINT [FK_INVOICE_MONTH_REF] FOREIGN KEY ([ID_MONTH_REF]) REFERENCES MONTH_REF ([ID_MONTH_REF])
	,CONSTRAINT [AK_INVOICE] UNIQUE ([INVOICE_NUMBER])
);
GO

CREATE TABLE CATEGORY (
	 [ID_CATEGORY]	INT			 NOT NULL IDENTITY (1,1)
	,[NAME]			VARCHAR(200) NOT NULL
	,[DESCRIPTION]  VARCHAR(200) NOT NULL
	,[ACTIVE]		BIT			 NOT NULL DEFAULT (0)
	,[DT_ICLO]		DATE		 NOT NULL
	,[TM_ICLO]		TIME(7)		 NOT NULL
	,[DT_END]		DATE		 NULL
	,[TM_END]		TIME(7)		 NULL
	,CONSTRAINT [PK_CATEGORY] PRIMARY KEY ([ID_CATEGORY])
	,CONSTRAINT [AK_CATEGORY] UNIQUE ([NAME])
);
GO

CREATE TABLE EXPENSE (
	 [ID_EXPENSE]	INT			  NOT NULL IDENTITY (1,1)
	,[ID_CATEGORY]  INT			  NOT NULL
	,[VALUE]		DECIMAL(10,2) NOT NULL			
	,[NAME]			VARCHAR(200)  NOT NULL
	,[DT_PAYMENT]	DATE		  NOT NULL
	,[DT_REF]		DATE		  NOT NULL
	,[ID_COMPANY]   INT			  NULL
	,[DT_ICLO]		DATE		  NOT NULL
	,[TM_ICLO]		TIME(7)		  NOT NULL
	,CONSTRAINT [PK_EXPENSE] PRIMARY KEY ([ID_EXPENSE])
	,CONSTRAINT [FK_EXPENSE_CATEGORY] FOREIGN KEY ([ID_CATEGORY]) REFERENCES CATEGORY ([ID_CATEGORY])
	,CONSTRAINT [FK_EXPENSE_COMPANY] FOREIGN KEY ([ID_COMPANY]) REFERENCES COMPANY ([ID_COMPANY])
);
GO

